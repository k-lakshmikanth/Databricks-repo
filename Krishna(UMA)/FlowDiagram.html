<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=5,IE=9" ><![endif]-->
<!DOCTYPE html>
<html>
<head>
<title>FlowDiagram</title>
<meta charset="utf-8"/>
</head>
<body><div class="mxgraph" style="max-width:100%;border:1px solid transparent;" data-mxgraph="{&quot;highlight&quot;:&quot;#0000ff&quot;,&quot;nav&quot;:true,&quot;resize&quot;:true,&quot;toolbar&quot;:&quot;zoom layers tags lightbox&quot;,&quot;edit&quot;:&quot;_blank&quot;,&quot;xml&quot;:&quot;&lt;mxfile host=\&quot;app.diagrams.net\&quot; modified=\&quot;2023-11-02T16:21:37.624Z\&quot; agent=\&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0\&quot; etag=\&quot;BCTacDE1t1XXS3GvPQ7d\&quot; version=\&quot;22.0.8\&quot; type=\&quot;github\&quot;&gt;\n  &lt;diagram id=\&quot;C5RBs43oDa-KdzZeNtuy\&quot; name=\&quot;Page-1\&quot;&gt;\n    &lt;mxGraphModel dx=\&quot;1687\&quot; dy=\&quot;2023\&quot; grid=\&quot;1\&quot; gridSize=\&quot;10\&quot; guides=\&quot;1\&quot; tooltips=\&quot;1\&quot; connect=\&quot;1\&quot; arrows=\&quot;1\&quot; fold=\&quot;1\&quot; page=\&quot;1\&quot; pageScale=\&quot;1\&quot; pageWidth=\&quot;827\&quot; pageHeight=\&quot;1169\&quot; math=\&quot;0\&quot; shadow=\&quot;0\&quot;&gt;\n      &lt;root&gt;\n        &lt;mxCell id=\&quot;WIyWlLk6GJQsqaUBKTNV-0\&quot; /&gt;\n        &lt;mxCell id=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-0\&quot; /&gt;\n        &lt;mxCell id=\&quot;cLSf2xtk1npk4WKIa0hI-8\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;WIyWlLk6GJQsqaUBKTNV-3\&quot; target=\&quot;sKV7Br36NTfYx774qnBV-22\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;cLSf2xtk1npk4WKIa0hI-9\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;WIyWlLk6GJQsqaUBKTNV-3\&quot; target=\&quot;sKV7Br36NTfYx774qnBV-4\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;WIyWlLk6GJQsqaUBKTNV-3\&quot; value=\&quot;MetaDataLookup\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#FFD966;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;382.5\&quot; y=\&quot;-840\&quot; width=\&quot;165\&quot; height=\&quot;80\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-2\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;800\&quot; y=\&quot;-610\&quot; as=\&quot;sourcePoint\&quot; /&gt;\n            &lt;mxPoint x=\&quot;800\&quot; y=\&quot;-610\&quot; as=\&quot;targetPoint\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;cLSf2xtk1npk4WKIa0hI-10\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;sKV7Br36NTfYx774qnBV-4\&quot; target=\&quot;sKV7Br36NTfYx774qnBV-17\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;cLSf2xtk1npk4WKIa0hI-17\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;sKV7Br36NTfYx774qnBV-4\&quot; target=\&quot;sKV7Br36NTfYx774qnBV-24\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-4\&quot; value=\&quot;Create Job\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=#FFD966;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;370\&quot; y=\&quot;-460\&quot; width=\&quot;190\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-42\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=12;fontColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;sKV7Br36NTfYx774qnBV-8\&quot; target=\&quot;sKV7Br36NTfYx774qnBV-41\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;cLSf2xtk1npk4WKIa0hI-15\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;sKV7Br36NTfYx774qnBV-8\&quot; target=\&quot;sKV7Br36NTfYx774qnBV-33\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-8\&quot; value=\&quot;Create Batch&amp;lt;br&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=#FFD966;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;370\&quot; y=\&quot;-10\&quot; width=\&quot;190\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;object label=\&quot;\&quot; id=\&quot;sKV7Br36NTfYx774qnBV-26\&quot;&gt;\n          &lt;mxCell style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=12;fontColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;sKV7Br36NTfYx774qnBV-17\&quot; target=\&quot;sKV7Br36NTfYx774qnBV-25\&quot; edge=\&quot;1\&quot;&gt;\n            &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n          &lt;/mxCell&gt;\n        &lt;/object&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-35\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=12;fontColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;sKV7Br36NTfYx774qnBV-17\&quot; target=\&quot;sKV7Br36NTfYx774qnBV-34\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-17\&quot; value=\&quot;Success&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; Fail/Cancel\&quot; style=\&quot;rhombus;whiteSpace=wrap;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;375\&quot; y=\&quot;-295\&quot; width=\&quot;180\&quot; height=\&quot;90\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-22\&quot; value=\&quot;&amp;lt;div style=&amp;quot;border-color: var(--border-color); text-align: left;&amp;quot;&amp;gt;1)This calls a notebook &amp;quot;get_src_meta_data&amp;quot;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color); text-align: left;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;border-color: var(--border-color); background-color: initial;&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color); text-align: left;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;border-color: var(--border-color); background-color: initial;&amp;quot;&amp;gt;2)All the tables which needs to be processed will be kept in Control table and this drives the entire pipeline execution process.&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color); text-align: left;&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color); text-align: left;&amp;quot;&amp;gt;3)Watermark value and load type is maintained here to handle Incremental and Full loads.&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color); text-align: left;&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color); text-align: left;&amp;quot;&amp;gt;4)Each entry is uniquely identified,it will have an active flag indicater so that we can disable in active entries.&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color); text-align: left;&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color); text-align: left;&amp;quot;&amp;gt;5)It will have column list where we&amp;amp;nbsp; will store all select statements in it and we use that to process the data.&amp;lt;/div&amp;gt;\&quot; style=\&quot;shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;962.5\&quot; y=\&quot;-905\&quot; width=\&quot;407.5\&quot; height=\&quot;210\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-24\&quot; value=\&quot;&amp;lt;div style=&amp;quot;border-color: var(--border-color); text-align: left;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;1)EDL_CONFIG_DEV.etl_job_history is the table where all job history is updated.&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;2)As part of initial process it will insert a new Job ID for the new process.&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;3)We are capturing success,running,cancel and failing statuses in job history table.&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;4)With job log ,when ever there is failure or cancelled will be processed in next iteration...e it will give a Retry attempt from where it is failed&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;960\&quot; y=\&quot;-650\&quot; width=\&quot;410\&quot; height=\&quot;180\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;cLSf2xtk1npk4WKIa0hI-13\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;sKV7Br36NTfYx774qnBV-25\&quot; target=\&quot;sKV7Br36NTfYx774qnBV-27\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-25\&quot; value=\&quot;Logging to Job History Table\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;740\&quot; y=\&quot;-280\&quot; width=\&quot;150\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;cLSf2xtk1npk4WKIa0hI-16\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;sKV7Br36NTfYx774qnBV-27\&quot; target=\&quot;sKV7Br36NTfYx774qnBV-4\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-27\&quot; value=\&quot;Retry Attempt&amp;amp;nbsp;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;740\&quot; y=\&quot;-460\&quot; width=\&quot;150\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-33\&quot; value=\&quot;&amp;lt;div style=&amp;quot;border-color: var(--border-color); text-align: left;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;1)etl_batch_history&amp;amp;nbsp;is the table where all batch history is updated.&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;2)As part of initial process it will insert a new New BatchID for the new batch.&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;3)We are capturing success,running,cancel and failing statuses in batch history table.&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;4)With batch log ,when ever there is failure or cancelled will be processed in next iteration...i.e it will give a Retry attempt from where it is failed&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;962.5\&quot; y=\&quot;-180\&quot; width=\&quot;410\&quot; height=\&quot;180\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;cLSf2xtk1npk4WKIa0hI-12\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;sKV7Br36NTfYx774qnBV-34\&quot; target=\&quot;sKV7Br36NTfYx774qnBV-8\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-34\&quot; value=\&quot;Logging to Job History table on success\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;390\&quot; y=\&quot;-130\&quot; width=\&quot;150\&quot; height=\&quot;50\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-44\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=12;fontColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;sKV7Br36NTfYx774qnBV-41\&quot; target=\&quot;sKV7Br36NTfYx774qnBV-43\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;cLSf2xtk1npk4WKIa0hI-14\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;sKV7Br36NTfYx774qnBV-41\&quot; target=\&quot;sKV7Br36NTfYx774qnBV-45\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-41\&quot; value=\&quot;Success&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; Fail/Cancel\&quot; style=\&quot;rhombus;whiteSpace=wrap;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;375\&quot; y=\&quot;110\&quot; width=\&quot;180\&quot; height=\&quot;90\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-51\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=12;fontColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;sKV7Br36NTfYx774qnBV-43\&quot; target=\&quot;sKV7Br36NTfYx774qnBV-50\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-43\&quot; value=\&quot;Logging to Batch History table on success\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;390\&quot; y=\&quot;290\&quot; width=\&quot;150\&quot; height=\&quot;50\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-48\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=12;fontColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;sKV7Br36NTfYx774qnBV-45\&quot; target=\&quot;sKV7Br36NTfYx774qnBV-47\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-45\&quot; value=\&quot;Logging to Job History Table\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;740\&quot; y=\&quot;125\&quot; width=\&quot;150\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-49\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=12;fontColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;sKV7Br36NTfYx774qnBV-47\&quot; target=\&quot;sKV7Br36NTfYx774qnBV-8\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-47\&quot; value=\&quot;Retry Attempt\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;740\&quot; y=\&quot;-10\&quot; width=\&quot;150\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-53\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=12;fontColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;sKV7Br36NTfYx774qnBV-50\&quot; target=\&quot;sKV7Br36NTfYx774qnBV-52\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;cLSf2xtk1npk4WKIa0hI-19\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;sKV7Br36NTfYx774qnBV-50\&quot; target=\&quot;cLSf2xtk1npk4WKIa0hI-0\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-50\&quot; value=\&quot;Create Process\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=#FFD966;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;370\&quot; y=\&quot;450\&quot; width=\&quot;190\&quot; height=\&quot;50\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;cLSf2xtk1npk4WKIa0hI-4\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;sKV7Br36NTfYx774qnBV-52\&quot; target=\&quot;cLSf2xtk1npk4WKIa0hI-3\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-52\&quot; value=\&quot;Source Data Extraction\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=#FFD966;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;370\&quot; y=\&quot;760\&quot; width=\&quot;190\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-54\&quot; value=\&quot;&amp;lt;div style=&amp;quot;border-color: var(--border-color); text-align: left;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;1)Data extraction notebook will accept the below parameters&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;DestinationSchema: &amp;lt;br&amp;gt;TableName: &amp;lt;br&amp;gt;SourceName: &amp;lt;br&amp;gt;ColumnList: &amp;lt;br&amp;gt;LoadType: &amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;2)In next step we will update the watermark value of table in the control table if it is full load.&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;3)We will have&amp;amp;nbsp;ctl_source_bl_mapping table where we get always latest schema.&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;4)With a mapping ID we will compare source and target schema and append this table so as every time we get latest schema.&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;5)When it is incremental load, through merge operation we update the ctl_source_bl_mapping&amp;amp;nbsp;by comparing source and target schema&amp;#39;s&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;6)When it is full load truncate and load is performed&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;962.5\&quot; y=\&quot;660\&quot; width=\&quot;407.5\&quot; height=\&quot;360\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;sKV7Br36NTfYx774qnBV-56\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=12;fontColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;sKV7Br36NTfYx774qnBV-52\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;960\&quot; y=\&quot;790\&quot; as=\&quot;targetPoint\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;cLSf2xtk1npk4WKIa0hI-0\&quot; value=\&quot;&amp;lt;div align=&amp;quot;left&amp;quot;&amp;gt;1)ETL_PROCESS_HISTORY is the table where all process history is maintained.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;2)As part of initial process it will insert a new New ExecutionID for the new process for each dataset and capturing row counts information before and after process completion including the duration. &amp;lt;br&amp;gt;&amp;lt;br&amp;gt;3)We will keep the both Batch and Process status as Running with ExecutionStartTime as ADF pipeline activity start time at this stage by keeping Target table row count 0 if it is in Full load mode otherwise record count from the Target table.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;4)Success, Running, Failed status are maintained.&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;strokeColor=default;align=left;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;961.25\&quot; y=\&quot;355\&quot; width=\&quot;407.5\&quot; height=\&quot;240\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;cLSf2xtk1npk4WKIa0hI-18\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;cLSf2xtk1npk4WKIa0hI-3\&quot; target=\&quot;cLSf2xtk1npk4WKIa0hI-5\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;cLSf2xtk1npk4WKIa0hI-23\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;cLSf2xtk1npk4WKIa0hI-3\&quot; target=\&quot;cLSf2xtk1npk4WKIa0hI-21\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;cLSf2xtk1npk4WKIa0hI-3\&quot; value=\&quot;Update Process\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=#FFD966;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;368.75\&quot; y=\&quot;1187.5\&quot; width=\&quot;190\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;cLSf2xtk1npk4WKIa0hI-5\&quot; value=\&quot;1)ETL_PROCESS_HISTORY is the table where all process history is maintained.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;2) Using the existing ExecutionID and Table details, if the process is completed without errors then it update the status to SUCCESS with ExecutionEndTime, Process rows count including duration, else it update the status to FAILED with error details.&amp;lt;br&amp;gt;\&quot; style=\&quot;shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;strokeColor=default;align=left;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;962.5\&quot; y=\&quot;1150\&quot; width=\&quot;410\&quot; height=\&quot;135\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;cLSf2xtk1npk4WKIa0hI-20\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; source=\&quot;cLSf2xtk1npk4WKIa0hI-21\&quot; target=\&quot;cLSf2xtk1npk4WKIa0hI-22\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;cLSf2xtk1npk4WKIa0hI-21\&quot; value=\&quot;Update Batch \&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=#FFD966;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;368.75\&quot; y=\&quot;1447.5\&quot; width=\&quot;190\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;cLSf2xtk1npk4WKIa0hI-22\&quot; value=\&quot;1)ETL_BATCH_HISTORY is the table where all batch history is updated.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;2)As part of initial process it will insert a new New BatchID for the new batch.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;3)We are capturing success,running,cancel and failing statuses in batch history table.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;4)With batch log ,when ever there is failure or cancelled will be processed in next iteration...i.e it will give a Retry attempt from where it is failed\&quot; style=\&quot;shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;strokeColor=default;align=left;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=default;\&quot; parent=\&quot;WIyWlLk6GJQsqaUBKTNV-1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;962.5\&quot; y=\&quot;1387.5\&quot; width=\&quot;410\&quot; height=\&quot;180\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n      &lt;/root&gt;\n    &lt;/mxGraphModel&gt;\n  &lt;/diagram&gt;\n&lt;/mxfile&gt;\n&quot;}"></div>
<script type="text/javascript" src="https://viewer.diagrams.net/js/viewer-static.min.js"></script>
</body>
</html>